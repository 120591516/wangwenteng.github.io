(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{742:function(s,a,t){"use strict";t.r(a);var e=t(5),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[s._v("说明")]),s._v(" "),t("p",[s._v("借助"),t("code",[s._v("Makefile")]),s._v("我们在编译过程中不再需要每次手动输入编译的命令和编译的参数，可以极大简化项目编译过程。")])]),s._v(" "),t("h2",{attrs:{id:"make介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#make介绍"}},[s._v("#")]),s._v(" make介绍")]),s._v(" "),t("p",[t("code",[s._v("make")]),s._v("是一个构建自动化工具，会在当前目录下寻找"),t("code",[s._v("Makefile")]),s._v("或"),t("code",[s._v("makefile")]),s._v("文件。如果存在相应的文件，它就会依据其中定义好的规则完成构建任务。")]),s._v(" "),t("h2",{attrs:{id:"makefile介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#makefile介绍"}},[s._v("#")]),s._v(" Makefile介绍")]),s._v(" "),t("p",[s._v("我们可以把"),t("code",[s._v("Makefile")]),s._v("简单理解为它定义了一个项目文件的编译规则。借助"),t("code",[s._v("Makefile")]),s._v("我们在编译过程中不再需要每次手动输入编译的命令和编译的参数，可以极大简化项目编译过程。同时使用"),t("code",[s._v("Makefile")]),s._v("也可以在项目中确定具体的编译规则和流程，很多开源项目中都会定义"),t("code",[s._v("Makefile")]),s._v("文件。")]),s._v(" "),t("p",[s._v("本文不会详细介绍"),t("code",[s._v("Makefile")]),s._v("的各种规则，只会给出Go项目中常用的"),t("code",[s._v("Makefile")]),s._v("示例。关于"),t("code",[s._v("Makefile")]),s._v("的详细内容推荐阅读"),t("a",{attrs:{href:"http://c.biancheng.net/view/7097.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Makefile教程"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"规则概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#规则概述"}},[s._v("#")]),s._v(" 规则概述")]),s._v(" "),t("p",[t("code",[s._v("Makefile")]),s._v("由多条规则组成，每条规则主要由两个部分组成，分别是依赖的关系和执行的命令。")]),s._v(" "),t("p",[s._v("其结构如下所示：")]),s._v(" "),t("div",{staticClass:"language-makefile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("[target] ...")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" [prerequisites] ...\n<tab>[command]\n    ...\n    ...\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("其中：")]),s._v(" "),t("ul",[t("li",[s._v("targets：规则的目标")]),s._v(" "),t("li",[s._v("prerequisites：可选的要生成 targets 需要的文件或者是目标。")]),s._v(" "),t("li",[s._v("command：make 需要执行的命令（任意的 shell 命令）。可以有多条命令，每一条命令占一行。")])]),s._v(" "),t("p",[s._v("举个例子：")]),s._v(" "),t("div",{staticClass:"language-makefile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\tCGO_ENABLED"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0 GOOS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux GOARCH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amd64 go build -o xx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),t("div",{staticClass:"language-makefile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin-target builtin"}},[s._v(".PHONY")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" all build run gotool clean help\n\nBINARY"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bluebell"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gotool build\n\n"),t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\tCGO_ENABLED"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0 GOOS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux GOARCH"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amd64 go build -o "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("BINARY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("go run ./\n\n"),t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("gotool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\tgo fmt ./\n\tgo vet ./\n\n"),t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("clean")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("if [ -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("BINARY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" ] "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" then rm "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("BINARY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" fi\n\n"),t("span",{pre:!0,attrs:{class:"token target symbol"}},[s._v("help")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"make - 格式化 Go 代码, 并编译生成二进制文件"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"make build - 编译 Go 代码, 生成二进制文件"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"make run - 直接运行 Go 代码"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"make clean - 移除二进制文件和 vim swap files"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("@")]),s._v("echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"make gotool - 运行 Go 工具 'fmt' and 'vet'\"")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("其中：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v('BINARY="bluebell"')]),s._v("是定义变量。")]),s._v(" "),t("li",[t("code",[s._v(".PHONY")]),s._v("用来定义伪目标。不创建目标文件，而是去执行这个目标下面的命令。")])]),s._v(" "),t("hr")])}),[],!1,null,null,null);a.default=n.exports}}]);